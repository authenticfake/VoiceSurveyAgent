{"ts":1765123822700,"mode":"harper","role":"user","content":"▶ IDEA voicesurveyagent | mode=harper model=gpt-5.1 profile=— core=[]","model":"gpt-5.1","attachments":[{"name":"IDEA_VoiceSurveyAgent (eng).md","path":"/Users/a.franco/dev/authenticfake/clike/clike_mvp/docs/IDEAs/IDEA_VoiceSurveyAgent (eng).md","id":null,"origin":"workspace","source":"workspace","content":"## 1. Formalization in **English**\n\n### Title\n\n**Voice Survey Agent** – AI Voice Agent for National and International Phone Surveys\n\n### Vision\n\nBuild an AI voice agent that can place national and international phone calls, speak natural language, and politely persuade people to participate in a short 3-question survey. The agent should integrate with generative models (GPT, Claude, Gemini) and telephony providers, automatically handling call outcomes, retries, and follow-up emails.\n\n### Problem Statement\n\nToday, phone-based surveys rely heavily on human agents, which is expensive, hard to scale, and inconsistent in quality. It is also difficult to orchestrate:\n\n* multiple call attempts,\n* handling busy/no-answer states,\n* sending confirmation or closure emails,\n* collecting and structuring responses.\n\nWe need an automated system that maintains a “human-like” conversation quality, is auditable, and complies with local regulations (privacy, consent, telemarketing).\n\nConsider the critical issues known to date that must be mitigated by the solution:\n* **Regulations**: You must be very strict about consent, opt-in, time limits, and exclusion list management (e.g., no spam, no political calls without permission, etc.).\n* **Quality of prompt design**: The agent must be persuasive but not aggressive, always respecting the \"no\" response and providing clear information about who it represents.\n* **Latency & resilience**: Audio streaming + real-time LLM must be well-designed, especially in the custom scenario - target < 800ms - 1.5sec;\n* **Observability/eval**: You will need logs and metrics to *truly* monitor how the agent behaves, also for compliance reasons.\n\n### Target Users & Context\n\n* **Client organizations**: research institutes, enterprises, public entities running structured surveys (customer satisfaction, market research, etc.).\n* **End user**: the person receiving the call who must:\n\n  * understand who is calling and why,\n  * decide whether to opt in,\n  * answer 3 questions (free text or guided choices).\n* **Technical context**:\n\n  * cloud or on-prem backend,\n  * integration with one or more LLMs (GPT, Claude, Gemini) via a gateway,\n  * telephony providers via APIs (Twilio/Vonage/Plivo/Telnyx) or voice AI platforms (Bland AI, Vapi, Retell).\n\n### Value & Expected Outcomes\n\n* Scale from tens to thousands of calls per day, across countries and languages.\n* Standardize tone of voice, script, and consent handling.\n* Lower cost per completed interview.\n* Full traceability: each call has an outcome, conversation log, and survey result.\n* Ability to experiment with different “agent personalities” (formal/informal, etc.) without changing the core infrastructure.\n\n---\n\n### Core Functional Flows\n\n#### 1. Campaign setup and call scheduling\n\n* Import a contact list (phone number, email, preferred language, existing consent flags).\n* Define the survey:\n\n  * opening/intro script,\n  * 3 questions: 1) Request for personal details (First Name, Surname, Age, Residence, Tax Code; 2) Favorite Places; 3) Favorite Restaurants\n  * Any minimum branching rules (e.g., if it rejects, what\n  * minimal branching rules (e.g., if user declines, end immediately).\n* Configure time windows and max retry attempts (e.g., 5 per contact).\n\n#### 2. Call where user answers **and** accepts the survey\n\n1. The agent places the call.\n2. When the person answers, the LLM-driven agent:\n\n   * introduces itself (identity, purpose, expected duration);\n   * explicitly asks for consent to proceed.\n3. If the person agrees, the agent asks the 3 questions and records the answers.\n4. Once finished, the system:\n\n   * closes the call with a “thank you”;\n   * publishes a `survey.completed` event to a queue with contact ID, answers, timestamp;\n   * a worker consumes the event and sends a pre-defined email to the respondent (thanks, information notice, reward link, etc.).\n5. The contact’s state becomes **“Completed”** (no more attempts).\n\n#### 3. Call with **no answer** or **busy**\n\n* If the call is not answered or the line is busy:\n\n  * log the attempt outcome (no answer/busy);\n  * push the contact back into a **retry queue** with an incremented attempt counter;\n  * a scheduler re-plans the call for a later time within allowed time windows.\n* After the maximum number of attempts (e.g., 5) is reached:\n\n  * the contact’s state becomes “Not reachable”;\n  * optionally, an informational email can be sent (e.g., “we tried to reach you for a survey, here is a link if you’d like to participate”), also driven by a queue (e.g., `survey.not_reached`).\n\n#### 4. Call where user refuses / cannot be convinced\n\n* If the person refuses or explicitly says they do not want to participate:\n\n  * the agent closes politely;\n  * the contact’s state becomes “Refused”;\n  * a `survey.refused` event is published, and if the process requires it,\n\n    * a short email can be sent (e.g., thanking them and confirming they will not be contacted again).\n\n---\n\n### Telephony integration modes\n\nThe agent must support two alternative, configurable integration modes.\n\n#### Mode A – **Custom LLM integration + Voice API provider (e.g., Twilio, etc.)**\n\n* Use “traditional” voice API providers:\n\n  * **Twilio Programmable Voice** for inbound/outbound calls and IVR/survey scenarios.([Twilio][1])\n  * **Vonage Voice API** to create and control outbound calls.([developer.vonage.com][2])\n  * **Plivo Voice API** for outbound and bulk calling.([plivo.com][3])\n  * **Telnyx Programmable Voice** for voice calling plus AI-oriented workflows (media streaming, etc.).([developers.telnyx.com][4])\n* Our gateway orchestrates:\n\n  * streaming speech-to-text,\n  * calls to the generative model (GPT/Claude/Gemini),\n  * streaming text-to-speech,\n  * survey state management.\n* Pros: full flexibility and control (model choice, routing, data residency).\n* Cons: higher engineering complexity (media streaming, latency, scaling).\n\n#### Mode B – **Voice AI platforms (Bland AI / Vapi / Retell)**\n\n* Leverage specialized voice AI platforms:\n\n  * **Bland AI** – enterprise-grade voice agents for inbound/outbound calls (sales, surveys, scheduling).([bland.ai][8])\n  * **Vapi** – developer platform for voice AI agents, with phone-call support and highly configurable APIs.([Vapi][6])\n  * **Retell AI** – API-first voice agent platform supporting inbound/outbound calls and multiple telephony providers.([retellai.com][7])\n* In this scenario:\n\n  * the platform handles telephony and often STT/TTS itself;\n  * we focus on:\n\n    * scripting the agent’s personality and behavior,\n    * integrating with our backend via webhooks to:\n\n      * store survey answers,\n      * receive call outcomes,\n      * trigger email and queue events.\n* Pros: much faster time-to-market; audio, latency, and concurrency are largely solved.\n* Cons: vendor lock-in, less low-level control, potential constraints on model choice and data residency.\n\n**Configuration requirement:**\n\n* An environment-level flag (e.g., `VOICE_PROVIDER_MODE = \"custom\" | \"bland\" | \"vapi\" | \"retell\"`) selects which adapter to use at runtime, with a stable domain-level interface for campaigns and call outcomes.\n\n---\n\n### Non-functional requirements\n\n* **Low conversational latency** (target < 1–2 seconds round-trip) to avoid “robotic pauses”.\n* **Multi-language support**, starting from English/Italian.\n* **Compliance & privacy**:\n\n  * respect for local regulations (GDPR, telemarketing rules, opt-in/out, time windows);\n  * controlled logging and retention for call recordings and transcripts.\n* **Scalability**: thousands of calls per day, with control over:\n\n  * call rate,\n  * max concurrent calls,\n  * multi-provider routing.\n* **Observability**: dashboards and metrics (answer rate, completion rate, refusal rate, costs).\n\n---\n\n### Short vendor list\n\n**Telephony / Voice API providers**\n\n* Twilio Programmable Voice.([Twilio][1])\n* Vonage Voice API.([developer.vonage.com][2])\n* Plivo Voice API.([plivo.com][3])\n* Telnyx Voice API.([developers.telnyx.com][4])\n\n**Voice AI agent platforms**\n\n* Bland AI.([bland.ai][8])\n* Vapi.([Vapi][6])\n* Retell AI.([retellai.com][7])\n\n---\n\n\n[1]: https://www.twilio.com/docs/voice?utm_source=chatgpt.com \"Programmable Voice\"\n[2]: https://developer.vonage.com/en/api/voice?utm_source=chatgpt.com \"Vonage Voice API Reference\"\n[3]: https://www.plivo.com/docs/voice/api/call/make-a-call?utm_source=chatgpt.com \"Make an outbound call\"\n[4]: https://developers.telnyx.com/docs/voice/programmable-voice/get-started?utm_source=chatgpt.com \"Getting Started with Telnyx Programmable Voice API\"\n[5]: https://www.bland.ai/?utm_source=chatgpt.com \"Bland AI | Automate Phone Calls with Conversational AI for ...\"\n[6]: https://vapi.ai/?utm_source=chatgpt.com \"Vapi - Build Advanced Voice AI Agents\"\n[7]: https://www.retellai.com/?utm_source=chatgpt.com \"AI Voice Agent Platform for Phone Call Automation\"\n[8]: https://www.bland.ai/voice-agent?utm_source=chatgpt.com \"Voice Agent That Sounds Human\"\n[9]: https://www.retellai.com/glossary/ai-voice-agent?utm_source=chatgpt.com \"AI Voice Agent\"\n","bytes_b64":null,"size":9112,"mime":"text/plain"}]}
{"ts":1765123899324,"mode":"harper","role":"system","content":"✔ IDEA voicesurveyagent done — [echo] manual::gpt-5.1 :: IDEA generation • [files] 1 • [text] 32 chars","model":"gpt-5.1","attachments":[{"name":"IDEA_VoiceSurveyAgent (eng).md","path":"/Users/a.franco/dev/authenticfake/clike/clike_mvp/docs/IDEAs/IDEA_VoiceSurveyAgent (eng).md","id":null,"origin":"workspace","source":"workspace","content":"## 1. Formalization in **English**\n\n### Title\n\n**Voice Survey Agent** – AI Voice Agent for National and International Phone Surveys\n\n### Vision\n\nBuild an AI voice agent that can place national and international phone calls, speak natural language, and politely persuade people to participate in a short 3-question survey. The agent should integrate with generative models (GPT, Claude, Gemini) and telephony providers, automatically handling call outcomes, retries, and follow-up emails.\n\n### Problem Statement\n\nToday, phone-based surveys rely heavily on human agents, which is expensive, hard to scale, and inconsistent in quality. It is also difficult to orchestrate:\n\n* multiple call attempts,\n* handling busy/no-answer states,\n* sending confirmation or closure emails,\n* collecting and structuring responses.\n\nWe need an automated system that maintains a “human-like” conversation quality, is auditable, and complies with local regulations (privacy, consent, telemarketing).\n\nConsider the critical issues known to date that must be mitigated by the solution:\n* **Regulations**: You must be very strict about consent, opt-in, time limits, and exclusion list management (e.g., no spam, no political calls without permission, etc.).\n* **Quality of prompt design**: The agent must be persuasive but not aggressive, always respecting the \"no\" response and providing clear information about who it represents.\n* **Latency & resilience**: Audio streaming + real-time LLM must be well-designed, especially in the custom scenario - target < 800ms - 1.5sec;\n* **Observability/eval**: You will need logs and metrics to *truly* monitor how the agent behaves, also for compliance reasons.\n\n### Target Users & Context\n\n* **Client organizations**: research institutes, enterprises, public entities running structured surveys (customer satisfaction, market research, etc.).\n* **End user**: the person receiving the call who must:\n\n  * understand who is calling and why,\n  * decide whether to opt in,\n  * answer 3 questions (free text or guided choices).\n* **Technical context**:\n\n  * cloud or on-prem backend,\n  * integration with one or more LLMs (GPT, Claude, Gemini) via a gateway,\n  * telephony providers via APIs (Twilio/Vonage/Plivo/Telnyx) or voice AI platforms (Bland AI, Vapi, Retell).\n\n### Value & Expected Outcomes\n\n* Scale from tens to thousands of calls per day, across countries and languages.\n* Standardize tone of voice, script, and consent handling.\n* Lower cost per completed interview.\n* Full traceability: each call has an outcome, conversation log, and survey result.\n* Ability to experiment with different “agent personalities” (formal/informal, etc.) without changing the core infrastructure.\n\n---\n\n### Core Functional Flows\n\n#### 1. Campaign setup and call scheduling\n\n* Import a contact list (phone number, email, preferred language, existing consent flags).\n* Define the survey:\n\n  * opening/intro script,\n  * 3 questions: 1) Request for personal details (First Name, Surname, Age, Residence, Tax Code; 2) Favorite Places; 3) Favorite Restaurants\n  * Any minimum branching rules (e.g., if it rejects, what\n  * minimal branching rules (e.g., if user declines, end immediately).\n* Configure time windows and max retry attempts (e.g., 5 per contact).\n\n#### 2. Call where user answers **and** accepts the survey\n\n1. The agent places the call.\n2. When the person answers, the LLM-driven agent:\n\n   * introduces itself (identity, purpose, expected duration);\n   * explicitly asks for consent to proceed.\n3. If the person agrees, the agent asks the 3 questions and records the answers.\n4. Once finished, the system:\n\n   * closes the call with a “thank you”;\n   * publishes a `survey.completed` event to a queue with contact ID, answers, timestamp;\n   * a worker consumes the event and sends a pre-defined email to the respondent (thanks, information notice, reward link, etc.).\n5. The contact’s state becomes **“Completed”** (no more attempts).\n\n#### 3. Call with **no answer** or **busy**\n\n* If the call is not answered or the line is busy:\n\n  * log the attempt outcome (no answer/busy);\n  * push the contact back into a **retry queue** with an incremented attempt counter;\n  * a scheduler re-plans the call for a later time within allowed time windows.\n* After the maximum number of attempts (e.g., 5) is reached:\n\n  * the contact’s state becomes “Not reachable”;\n  * optionally, an informational email can be sent (e.g., “we tried to reach you for a survey, here is a link if you’d like to participate”), also driven by a queue (e.g., `survey.not_reached`).\n\n#### 4. Call where user refuses / cannot be convinced\n\n* If the person refuses or explicitly says they do not want to participate:\n\n  * the agent closes politely;\n  * the contact’s state becomes “Refused”;\n  * a `survey.refused` event is published, and if the process requires it,\n\n    * a short email can be sent (e.g., thanking them and confirming they will not be contacted again).\n\n---\n\n### Telephony integration modes\n\nThe agent must support two alternative, configurable integration modes.\n\n#### Mode A – **Custom LLM integration + Voice API provider (e.g., Twilio, etc.)**\n\n* Use “traditional” voice API providers:\n\n  * **Twilio Programmable Voice** for inbound/outbound calls and IVR/survey scenarios.([Twilio][1])\n  * **Vonage Voice API** to create and control outbound calls.([developer.vonage.com][2])\n  * **Plivo Voice API** for outbound and bulk calling.([plivo.com][3])\n  * **Telnyx Programmable Voice** for voice calling plus AI-oriented workflows (media streaming, etc.).([developers.telnyx.com][4])\n* Our gateway orchestrates:\n\n  * streaming speech-to-text,\n  * calls to the generative model (GPT/Claude/Gemini),\n  * streaming text-to-speech,\n  * survey state management.\n* Pros: full flexibility and control (model choice, routing, data residency).\n* Cons: higher engineering complexity (media streaming, latency, scaling).\n\n#### Mode B – **Voice AI platforms (Bland AI / Vapi / Retell)**\n\n* Leverage specialized voice AI platforms:\n\n  * **Bland AI** – enterprise-grade voice agents for inbound/outbound calls (sales, surveys, scheduling).([bland.ai][8])\n  * **Vapi** – developer platform for voice AI agents, with phone-call support and highly configurable APIs.([Vapi][6])\n  * **Retell AI** – API-first voice agent platform supporting inbound/outbound calls and multiple telephony providers.([retellai.com][7])\n* In this scenario:\n\n  * the platform handles telephony and often STT/TTS itself;\n  * we focus on:\n\n    * scripting the agent’s personality and behavior,\n    * integrating with our backend via webhooks to:\n\n      * store survey answers,\n      * receive call outcomes,\n      * trigger email and queue events.\n* Pros: much faster time-to-market; audio, latency, and concurrency are largely solved.\n* Cons: vendor lock-in, less low-level control, potential constraints on model choice and data residency.\n\n**Configuration requirement:**\n\n* An environment-level flag (e.g., `VOICE_PROVIDER_MODE = \"custom\" | \"bland\" | \"vapi\" | \"retell\"`) selects which adapter to use at runtime, with a stable domain-level interface for campaigns and call outcomes.\n\n---\n\n### Non-functional requirements\n\n* **Low conversational latency** (target < 1–2 seconds round-trip) to avoid “robotic pauses”.\n* **Multi-language support**, starting from English/Italian.\n* **Compliance & privacy**:\n\n  * respect for local regulations (GDPR, telemarketing rules, opt-in/out, time windows);\n  * controlled logging and retention for call recordings and transcripts.\n* **Scalability**: thousands of calls per day, with control over:\n\n  * call rate,\n  * max concurrent calls,\n  * multi-provider routing.\n* **Observability**: dashboards and metrics (answer rate, completion rate, refusal rate, costs).\n\n---\n\n### Short vendor list\n\n**Telephony / Voice API providers**\n\n* Twilio Programmable Voice.([Twilio][1])\n* Vonage Voice API.([developer.vonage.com][2])\n* Plivo Voice API.([plivo.com][3])\n* Telnyx Voice API.([developers.telnyx.com][4])\n\n**Voice AI agent platforms**\n\n* Bland AI.([bland.ai][8])\n* Vapi.([Vapi][6])\n* Retell AI.([retellai.com][7])\n\n---\n\n\n[1]: https://www.twilio.com/docs/voice?utm_source=chatgpt.com \"Programmable Voice\"\n[2]: https://developer.vonage.com/en/api/voice?utm_source=chatgpt.com \"Vonage Voice API Reference\"\n[3]: https://www.plivo.com/docs/voice/api/call/make-a-call?utm_source=chatgpt.com \"Make an outbound call\"\n[4]: https://developers.telnyx.com/docs/voice/programmable-voice/get-started?utm_source=chatgpt.com \"Getting Started with Telnyx Programmable Voice API\"\n[5]: https://www.bland.ai/?utm_source=chatgpt.com \"Bland AI | Automate Phone Calls with Conversational AI for ...\"\n[6]: https://vapi.ai/?utm_source=chatgpt.com \"Vapi - Build Advanced Voice AI Agents\"\n[7]: https://www.retellai.com/?utm_source=chatgpt.com \"AI Voice Agent Platform for Phone Call Automation\"\n[8]: https://www.bland.ai/voice-agent?utm_source=chatgpt.com \"Voice Agent That Sounds Human\"\n[9]: https://www.retellai.com/glossary/ai-voice-agent?utm_source=chatgpt.com \"AI Voice Agent\"\n","bytes_b64":null,"size":9112,"mime":"text/plain"}]}
{"ts":1765125228823,"mode":"harper","role":"user","content":"▶ SPEC  | mode=harper model=gpt-5.1 profile=— core=[]","model":"gpt-5.1","attachments":[]}
{"ts":1765125367536,"mode":"harper","role":"system","content":"✔ SPEC  done — [echo] manual::gpt-5.1 :: SPEC generation • [files] 1 • [text] 32 chars","model":"gpt-5.1","attachments":[]}
{"ts":1765125697306,"mode":"harper","role":"user","content":"▶ PLAN  | mode=harper model=gpt-5.1 profile=— core=[\"SPEC.md\",\"TECH_CONSTRAINTS.yaml\"]","model":"gpt-5.1","attachments":[]}
{"ts":1765125909473,"mode":"harper","role":"system","content":"✔ PLAN  done — [echo] Plan phase: manual::gpt-5.1 :: PLAN generation • [files] 8 • [text] 32 chars","model":"gpt-5.1","attachments":[]}
{"ts":1765126288618,"mode":"harper","role":"user","content":"▶ KIT  | mode=harper model=gpt-5.1 profile=— core=[\"SPEC.md\",\"PLAN.md\",\"TECH_CONSTRAINTS.yaml\"]","model":"gpt-5.1","attachments":[]}
{"ts":1765126501655,"mode":"harper","role":"system","content":"✔ KIT  done — [echo] manual::gpt-5.1 :: KIT generation • [files] 14 • [text] 31 chars","model":"gpt-5.1","attachments":[]}
{"ts":1765126688453,"mode":"harper","role":"user","content":"▶ KIT RRQ-001 | mode=harper model=gpt-5.1-codex profile=— core=[\"SPEC.md\",\"PLAN.md\",\"TECH_CONSTRAINTS.yaml\"]","model":"gpt-5.1-codex","attachments":[]}
{"ts":1765126913334,"mode":"harper","role":"system","content":"✔ KIT RRQ-001 done — [echo] manual::gpt-5.1-codex :: KIT generation • [files] 20 • [text] 31 chars","model":"gpt-5.1-codex","attachments":[]}
